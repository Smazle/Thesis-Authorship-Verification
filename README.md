# Authorship Verification

## Training a network

To train a network you need two datafiles. A training file and a validation
file. The training file is used for training and the validation for early
stopping. If we for example wanted to train a network with the name
*network_name* using the training data file *training_file* and validation
data file *validation_file*, then we would run the command:

```
python -m src.networks.generic_network network_name create-reader training_file\
    validation_file
```

That command will start training the network on the training datafile. The
program will save several files in the directory it is run in. The files are:

 * *reader.p*, which contains information used to map characters to integers.
   If the network is to be used after training that file has to be saved.

 * *weights.<e>-<vl>.hdf5*, where <e> is an epoch number and <vl> is the
   validation loss in that epoch. One of these files will be generated at the
   end of each epoch. They contain the weights that have been computed at the
   end of that epoch. The weights can then be loaded by the network later to
   produce a model.

 * *final_model.hdf5*, which is a Keras model that can be used to predict new
   samples. Note that the final model is not necessarily the model with the
   lowest validation loss. Instead it is simply the model that use the current
   weights whenever the training was stopped. That means that in most cases the
   final model can just be deleted after training.

It is possible to have the program output a file containing the history of
training and validation loss and training and validation accuracy in each epoch
of training. If that is needed the option `--history` can be given as in:

```
python -m src.networks.generic_network network_name --history history.csv\
    create-reader training_file validation_file
```

It is also possible for the program to save a graph of the network it is
training for that the `--graph` option has to be given as in:

```
python -m src.networks.generic_network network_name --graph graph.png\
    create-reader training_file validation_file
```

## Continue training

If for some reason the training of a network has to be stopped the training can
be continued later. To continue the training of the networks a file containing
the weights and a *reader.p* file is required. The training can then be
continued with the command:

```
python -m src.networks.generic_network network_name --weights weights.hdf5\
    load-reader ./reader.p
```

## Evaluating trained network

The first step in evaluating a trained network is to generate a Keras model.
The model *final_model.hdf5* is rarely what is needed. As explained earlier it
is not the best weights that are saved but the "last" weights. Instead a model
using the best weights can be generated by finding the weight file corresponding
to the lowest validation loss (maybe by using a history file). When such a
weight file has been identified the model can be generated with:

```
python -m src.networks.generic_network network_name --weights best_weights.hdf5\
    --epochs 0 load-reader ./reader.p
```

The `--epochs 0` option make sure that we train 0 epochs. Instead the command
will load the weights from the weights file and generate a *final_model.hdf5*
using those weights. It is that model that we want to evaluate.

TODO: Continue.

## Data format

TODO: Describe

## Adding a network

TODO: Describe
